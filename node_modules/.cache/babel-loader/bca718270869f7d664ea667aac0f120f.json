{"remainingRequest":"/Users/tql_yy/Documents/code/use_one/node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js!/Users/tql_yy/Documents/code/use_one/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!/Users/tql_yy/Documents/code/use_one/node_modules/_vue-loader@15.10.0@vue-loader/lib/index.js??vue-loader-options!/Users/tql_yy/Documents/code/use_one/src/views/login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tql_yy/Documents/code/use_one/src/views/login/index.vue","mtime":1658222307876},{"path":"/Users/tql_yy/Documents/code/use_one/babel.config.js","mtime":1657511087035},{"path":"/Users/tql_yy/Documents/code/use_one/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tql_yy/Documents/code/use_one/node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/tql_yy/Documents/code/use_one/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tql_yy/Documents/code/use_one/node_modules/_vue-loader@15.10.0@vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvVXNlcnMvdHFsX3l5L0RvY3VtZW50cy9jb2RlL3VzZV9vbmUvbm9kZV9tb2R1bGVzL19AYmFiZWxfcnVudGltZUA3LjE4LjZAQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiKTsKCnZhciBfc2VsZWN0QXJlYSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi9jb21wb25lbnRzL3NlbGVjdEFyZWEiKSk7Cgp2YXIgX2FwaSA9IHJlcXVpcmUoIi4uLy4uL2FwaS9hcGkiKTsKCnZhciBfZGVmYXVsdCA9IHsKICBjb21wb25lbnRzOiB7CiAgICBTZWxlY3RBcmVhOiBfc2VsZWN0QXJlYS5kZWZhdWx0CiAgfSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IHZhbGlkYXRpb25QaG9uZSA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsKICAgICAgaWYgKHRoaXMuZm9ybS5waG9uZV9wcmVmaXggPT0gJycpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IodGhpcy4kdCgn6K+36YCJ5oup5Zu95a625Yy65Y+3JykpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9IC8vIH0KCiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgIGJvb2w6IHsKICAgICAgICBTZWxlY3RBcmVhOiBmYWxzZQogICAgICB9LAogICAgICBOYXRpb25hbE51bWJlcjogewogICAgICAgIGxvZ286ICcnCiAgICAgIH0sCiAgICAgIGVtYWlsOiBmYWxzZSwKICAgICAgZm9ybTogewogICAgICAgIHBob25lX3ByZWZpeDogJycsCiAgICAgICAgcGhvbmU6ICcnLAogICAgICAgIGVtYWlsOiAnJywKICAgICAgICBwYXNzd29yZDogJycKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBwaG9uZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgn6K+36L6T5YWl5omL5py65Y+356CBJyksCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9LCB7CiAgICAgICAgICB2YWxpZGF0b3I6IHZhbGlkYXRpb25QaG9uZSwKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIGVtYWlsOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCfor7fovpPlhaXpgq7nrrEnKSwKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH0sIHsKICAgICAgICAgIHZhbGlkYXRvcjogbmV3IFJlZ0V4cCgpLmVtYWlsLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfV0sCiAgICAgICAgcGFzc3dvcmQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ+ivt+i+k+WFpeWvhueggScpLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfSwgewogICAgICAgICAgbWluOiA4LAogICAgICAgICAgbWF4OiAxMiwKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ+mVv+W6puWcqDjliLAxMuS4quWtl+espicpLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfSwgewogICAgICAgICAgdmFsaWRhdG9yOiBuZXcgUmVnRXhwKCkucGFzc3dvcmQsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9LAogICAgICBSZXR1cm5Vcmw6ICcvaW5kZXgnCiAgICB9OwogIH0sCgogIHdhdGNoOiB7CiAgICAnJHJvdXRlLnF1ZXJ5JzogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uICh2KSB7CiAgICAgICAgaWYgKHYuUmV0dXJuVXJsKSB7CiAgICAgICAgICB0aGlzLlJldHVyblVybCA9IHYuUmV0dXJuVXJsOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2xvc2VBcmVhKCkgewogICAgICB0aGlzLmJvb2wuU2VsZWN0QXJlYSA9IGZhbHNlOwogICAgfSwKCiAgICBzd2l0Y2hFbWFpbChib29sKSB7CiAgICAgIHRoaXMuZW1haWwgPSBib29sOwogICAgICB0aGlzLiRyZWZzWydmb3JtJ10ucmVzZXRGaWVsZHMoKTsKICAgIH0sCgogICAgb25TZWxlY3RBcmVhKHJvdykgewogICAgICB0aGlzLk5hdGlvbmFsTnVtYmVyID0gcm93OwogICAgICB0aGlzLmZvcm0ucGhvbmVfcHJlZml4ID0gcm93LnByZWZpeDsKICAgIH0sCgogICAgb25TdWJtaXQoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUocmVzID0+IHsKICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICB0aGlzLm9uTG9naW4oKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBhc3luYyBvbkxvZ2luKCkgewogICAgICB0aGlzLiR0b2FzdC5sb2FkaW5nKHsKICAgICAgICBkdXJhdGlvbjogMCwKICAgICAgICBmb3JiaWRDbGljazogdHJ1ZSwKICAgICAgICBtZXNzYWdlOiAn55m75b2V5LitJwogICAgICB9KTsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndXNlcnMvbG9naW4nLCB7CiAgICAgICAgYWNjb3VudDogdGhpcy5lbWFpbCA/IHRoaXMuZm9ybS5lbWFpbCA6IHRoaXMuZm9ybS5waG9uZSwKICAgICAgICBwYXNzd29yZDogdGhpcy5mb3JtLnBhc3N3b3JkCiAgICAgIH0pOwogICAgICB0aGlzLiR0b2FzdC5jbGVhcigpOwoKICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKDAsIF9hcGkuVXNlckluZm8pKHJlc3BvbnNlLmRhdGEuYWNjZXNzX3Rva2VuKTsKICAgICAgICBjb25zdCB7CiAgICAgICAgICBjb2RlLAogICAgICAgICAgZGF0YQogICAgICAgIH0gPSByZXN1bHQ7CgogICAgICAgIGlmIChjb2RlICE9IDIwMCkgewogICAgICAgICAgdGhpcy4kdG9hc3QoJ+eZu+W9leW8guW4uO+8jOivt+eojeWQjuWGjeivlScpOwogICAgICAgICAgcm91dGVyLmN1cnJlbnRSb3V0ZTsKICAgICAgICB9CgogICAgICAgIDsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2N1cnJlbnQvdXBBY2NvdW50JywgZGF0YSk7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgcGF0aDogdGhpcy5SZXR1cm5VcmwKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"mappings":";;;;;;;;;;;AA0DA;;AACA;;eAEA;EACAA;IAAAC;EAAA,CADA;;EAEAC;IACA;MACA;QACAC;MACA,CAFA,MAEA;QACAA;MACA,CALA,CAMA;;IACA,CAPA;;IASA;MACAC;QACAH;MADA,CADA;MAIAI;QACAC;MADA,CAJA;MAOAC,YAPA;MAQAC;QACAC,gBADA;QAEAC,SAFA;QAGAH,SAHA;QAIAI;MAJA,CARA;MAcAC;QACAF,QACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAD;QAAA,CAFA,CADA;QAKAR,QACA;UAAAM;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAD;QAAA,CAFA,CALA;QASAJ,WACA;UAAAE;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAE;UAAAC;UAAAJ;UAAAC;QAAA,CAFA,EAGA;UAAAC;UAAAD;QAAA,CAHA;MATA,CAdA;MA6BAI;IA7BA;EA+BA,CA3CA;;EA4CAC;IACA;MACAC,eADA;MAEAC;QACA;UACA;QACA;MACA;IANA;EADA,CA5CA;EAsDAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;MACA;IACA,CAPA;;IAQAC;MACA;MACA;IACA,CAXA;;IAYAC;MACA;QACA;UACA;QACA;MACA,CAJA;IAKA,CAlBA;;IAmBA;MACA;QACAC,WADA;QAEAC,iBAFA;QAGAf;MAHA;MAMA;QACAgB,uDADA;QAEAnB;MAFA;MAKA;;MAEA;QACA;QACA;UAAAoB;UAAA7B;QAAA;;QACA;UACA;UACA8B;QACA;;QAAA;QACA;QACA;UACAC;QADA;MAGA;IACA;;EA7CA;AAtDA,C","names":["components","SelectArea","data","callback","bool","NationalNumber","logo","email","form","phone_prefix","phone","password","rules","required","message","trigger","validator","min","max","ReturnUrl","watch","immediate","handler","methods","closeArea","switchEmail","onSelectArea","onSubmit","duration","forbidClick","account","code","router","path"],"sourceRoot":"src/views/login","sources":["index.vue"],"sourcesContent":["<!--\n * @Name: 登录\n * @Date: 2022-06-25 20:38:13\n * @LastEditors: VSCode\n * @LastEditTime: 2022-07-04 20:12:25\n-->\n<template>\n    <div>\n        <P-main class=\"login\" v-show=\"!bool.SelectArea\">\n            <Navigation :languageSwitch=\"true\" />\n            <h3>{{$t('密码登录')}}</h3>\n            <el-form :model=\"form\" ref=\"form\" :rules=\"rules\" label-position=\"top\">\n                <el-form-item prop=\"phone\" v-if=\"!email\">\n                    <P-input :title=\"$t('手机')\" :iconBorder=\"true\" v-model=\"form.phone\" :placeholder=\"$t('请输入手机号码')\">\n                        <template #more>\n                            <div class=\"email\" @click=\"switchEmail(true)\">{{$t('邮箱登录')}}</div>\n                        </template>\n                        <template #icon>\n                            <div slot='icon'>\n                                <div class=\"user-left ui-flex-row\" @click=\"bool.SelectArea = true\">\n                                    <div v-if=\"form.phone_prefix\"><img :src=\"NationalNumber.logo\"\n                                            class=\"theNationalFlag\">\n                                    </div>\n                                    <div v-if=\"form.phone_prefix\" class=\"name\">{{form.phone_prefix}}</div>\n                                    <div v-if=\"!form.phone_prefix\" class=\"ui-col-fei m-5-r\">{{$t('请选择')}}</div>\n                                    <B-svg name=\"jianTouXia\" class-name=\"jianTouXia\" />\n                                </div>\n                            </div>\n                        </template>\n                    </P-input>\n                </el-form-item>\n\n                <el-form-item prop=\"email\" v-if=\"email\">\n                    <P-input :title=\"$t('邮箱')\" v-model=\"form.email\" icon=\"icon-youxiang\" :placeholder=\"$t('请输入邮箱')\">\n                        <template #more>\n                            <div class=\"email\" @click=\"switchEmail(false)\">{{$t('手机登录')}}</div>\n                        </template>\n                    </P-input>\n                </el-form-item>\n\n                <el-form-item prop=\"password\">\n                    <P-input :title=\"$t('密码')\" v-model=\"form.password\" icon=\"icon-suoding\" :show-password=\"true\"\n                        :placeholder=\"$t('输入您的登录密码')\" />\n                </el-form-item>\n            </el-form>\n            <P-button type=\"primary\" class=\"btn-primary h-44-i m-60-t-i\" @click=\"onSubmit('form')\">{{$t('登录')}}\n            </P-button>\n\n            <div class=\"registered ui-flex-center m-15-t\">\n                <B-a href=\"/registered\">{{$t('注册账号')}}</B-a>\n                <B-a href=\"/forgotpassword\">{{$t('忘记密码')}}?</B-a>\n            </div>\n        </P-main>\n        <SelectArea v-model=\"bool.SelectArea\" @click=\"onSelectArea\"  @close-area=\"closeArea\"/>\n    </div>\n</template>\n\n<script>\nimport SelectArea from './components/selectArea';\nimport { UserInfo } from '../../api/api'\n\nexport default {\n    components: { SelectArea },\n    data() {\n        const validationPhone = (rule, value, callback) => {\n            if (this.form.phone_prefix == '') {\n                callback(new Error(this.$t('请选择国家区号')));\n            }else {\n               callback()\n            }\n            // }\n        }\n\n        return {\n            bool: {\n                SelectArea: false\n            },\n            NationalNumber: {\n                logo: ''\n            },\n            email: false,\n            form: {\n                phone_prefix: '',\n                phone: '',\n                email: '',\n                password: ''\n            },\n            rules: {\n                phone: [\n                    { required: true, message: this.$t('请输入手机号码'), trigger: 'blur' },\n                    { validator: validationPhone, trigger: 'blur' }\n                ],\n                email: [\n                    { required: true, message: this.$t('请输入邮箱'), trigger: 'blur' },\n                    { validator: new RegExp().email, trigger: 'blur' }\n                ],\n                password: [\n                    { required: true, message: this.$t('请输入密码'), trigger: 'blur' },\n                    { min: 8, max: 12, message: this.$t('长度在8到12个字符'), trigger: 'blur' },\n                    { validator: new RegExp().password, trigger: 'blur' }\n                ]\n            },\n            ReturnUrl: '/index'\n        }\n    },\n    watch: {\n        '$route.query': {\n            immediate: true,\n            handler: function (v) {\n                if (v.ReturnUrl) {\n                    this.ReturnUrl = v.ReturnUrl\n                }\n            }\n        },\n    },\n    methods: {\n        closeArea(){\n            this.bool.SelectArea = false;\n        },  \n        switchEmail(bool) {\n            this.email = bool\n            this.$refs['form'].resetFields();\n        },\n        onSelectArea(row) {\n            this.NationalNumber = row\n            this.form.phone_prefix = row.prefix\n        },\n        onSubmit(formName) {\n            this.$refs[formName].validate((res) => {\n                if (res) {\n                    this.onLogin()\n                }\n            });\n        },\n        async onLogin() {\n            this.$toast.loading({\n                duration: 0,\n                forbidClick: true,\n                message: '登录中'\n            });\n\n            const response = await this.$store.dispatch('users/login', {\n                account: this.email ? this.form.email : this.form.phone,\n                password: this.form.password\n            })\n\n            this.$toast.clear();\n\n            if (response.code == 200) {\n                const result = await UserInfo(response.data.access_token);\n                const { code,data } = result;\n                if(code != 200){\n                    this.$toast('登录异常，请稍后再试');\n                    router.currentRoute\n                };\n                this.$store.commit('current/upAccount',data)\n                this.$router.push({\n                    path: this.ReturnUrl\n                })\n            }\n        }\n    }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.email {\n    height: 20px;\n    font-size: 14px;\n    color: #2cbc94;\n}\n\n.login {\n    .theNationalFlag {\n        height: 15px;\n        width: 15px;\n    }\n    .user-left {\n        .jianTouXia {\n            width: 13px;\n            height: 13px;\n            fill: #2cbc94;\n        }\n        .name {\n            color: #2cbc94;\n            margin: 0px 3px;\n        }\n    }\n}\n\n.registered {\n    font-size: 14px;\n    color: #999999;\n}\n</style>"]}]}